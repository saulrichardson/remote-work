{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Codex Planner Contract",
  "type": "object",
  "additionalProperties": false,
  "required": ["tasks"],
  "properties": {
    "tasks": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "task_id",
          "title",
          "brief",
          "repo_path",
          "worktree_path",
          "branch_base",
          "branch_name",
          "reference_docs"
        ],
        "properties": {
          "task_id": {
            "type": "string",
            "pattern": "^[a-z0-9\\-_]+$",
            "description": "Slug used for logging and worktree naming."
          },
          "title": {
            "type": "string",
            "description": "Short human-readable label for the task."
          },
          "brief": {
            "type": "string",
            "description": "Natural-language instructions Codex should follow."
          },
          "repo_path": {
            "type": "string",
            "description": "Relative path to the repository root to use ('.' for the main repo)."
          },
          "worktree_path": {
            "type": "string",
            "description": "Relative path for the git worktree (e.g., 'worktrees/task-foo')."
          },
          "branch_base": {
            "type": "string",
            "description": "Existing ref the new branch should track (e.g., 'main')."
          },
          "branch_name": {
            "type": "string",
            "description": "Git branch to create inside the worktree."
          },
          "reference_docs": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string"
            },
            "description": "Repo-relative paths the worker must review before making changes."
          }
        }
      }
    }
  }
}
