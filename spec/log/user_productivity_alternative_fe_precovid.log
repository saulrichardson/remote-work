-----------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/saul/Dropbox/Remote Work Startups/main/spec/log/user_productivity_alternative_fe_precovid.log
  log type:  text
 opened on:   5 Jun 2025, 20:32:05

. 
. // 0) Setup environment
. do "../src/globals.do"

. global raw_data "../data/raw"

. global processed_data  "../data/processed"

. global results "../results/raw"

. global clean_results "../results/cleaned"

. 
. // default user panel variant (unbalanced | balanced | precovid)
. global user_panel_variant "precovid"

. 
. 
. 
end of do-file

. 
. // 1) Common settings
. local result_dir "$results/`specname'"

. capture mkdir "`result_dir'"

. 
. local outcomes total_contributions_q100 

. // restricted_contributions_q100
. 
. *--- main results -------------------------------------------------------------
. tempfile out  

. capture postclose handle

. postfile handle ///
>     str20   model_type          ///
>     str20   fe_tag              ///
>     str40  outcome             ///
>     str40  param               ///
>     double coef se pval pre_mean ///
>     double rkf nobs            ///
>     using `out', replace
(file /var/folders/hg/s3xm9w393gxby64_zklmhgbc0000gn/T//S_56802.000001 not found)

. 
. 
. *--- first-stage results (coefficients + diagnostics) -------------------------
. tempfile out_fs

. capture postclose handle_fs

. postfile handle_fs ///
>     str20   fe_tag              ///  "fyh", "time", "firm", "none"
>     str40  outcome             ///
>     str20   endovar             ///  "var3" / "var5"
>     str40  param               ///  var6 / var7 / var4
>     double coef se pval        ///
>     double partialF rkf nobs   ///
>     using `out_fs', replace
(file /var/folders/hg/s3xm9w393gxby64_zklmhgbc0000gn/T//S_56802.000002 not found)

. 
.         
. //-------------------------------------------------------------
. // Firm + user + year FE ("fyh")
. //-------------------------------------------------------------
. local feopt "absorb(firm_id user_id yh)"

. local tag   "fyhu"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=fyhu)
   – outcome: total_contributions_q100
(dropped 1443 singleton observations)
(MWFE estimator converged in 80 iterations)

HDFE Linear regression                            Number of obs   =    229,862
Absorbing 3 HDFE groups                           F(   3,  35788) =       4.30
Statistics robust to heteroskedasticity           Prob > F        =     0.0048
                                                  R-squared       =     0.5120
                                                  Adj R-squared   =     0.4154
                                                  Within R-sq.    =     0.0001
Number of clusters (user_id) =     35,789         Root MSE        =    21.3218

                           (Std. err. adjusted for 35,789 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   .0351778    .452934     0.08   0.938    -.8525865    .9229421
        var5 |   3.348483   1.049727     3.19   0.001     1.290987     5.40598
        var4 |  -2.994229   .9105734    -3.29   0.001     -4.77898   -1.209477
       _cons |   76.54872   .1380704   554.42   0.000      76.2781    76.81934
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2151           1        2150     |
     user_id |     35789       35789           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 1443 singleton observations)
(MWFE estimator converged in 80 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35789                Number of obs =   229862
                                                      F(  3, 35788) =     1.33
                                                      Prob > F      =   0.2616
Total (centered) SS     =  87251870.26                Centered R2   =  -0.0005
Total (uncentered) SS   =  87251870.26                Uncentered R2 =  -0.0005
Residual SS             =  87291385.87                Root MSE      =    19.58

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   3.879417   3.995425     0.97   0.332    -3.951737    11.71057
        var5 |   .6094645   4.857187     0.13   0.900    -8.910769     10.1297
        var4 |  -1.425919    3.52147    -0.40   0.686    -8.328106    5.476268
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            266.393
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):             1850.988
                         (Kleibergen-Paap rk Wald F statistic):        140.597
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2151           1        2150     |
     user_id |     35789       35789           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. //-------------------------------------------------------------
. // firm x user + yh
. //-------------------------------------------------------------
. local feopt "absorb(firm_id#user_id yh)"

. local tag   "firmbyuseryh"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=firmbyuseryh)
   – outcome: total_contributions_q100
(dropped 6597 singleton observations)
(MWFE estimator converged in 8 iterations)

HDFE Linear regression                            Number of obs   =    224,708
Absorbing 2 HDFE groups                           F(   3,  35478) =       7.23
Statistics robust to heteroskedasticity           Prob > F        =     0.0001
                                                  R-squared       =     0.5527
                                                  Adj R-squared   =     0.4477
                                                  Within R-sq.    =     0.0001
Number of clusters (user_id) =     35,479         Root MSE        =    20.4806

                           (Std. err. adjusted for 35,479 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -.1867437   .4587737    -0.41   0.684    -1.085954    .7124668
        var5 |   4.416104   1.058933     4.17   0.000     2.340562    6.491646
        var4 |  -4.140034   .9203786    -4.50   0.000    -5.944005   -2.336064
       _cons |   76.99593   .1396971   551.16   0.000     76.72212    77.26974
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------------+
       Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------------+---------------------------------------|
   firm_id#user_id |     42710       42710           0    *|
                yh |        11           1          10     |
-----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 6597 singleton observations)
(MWFE estimator converged in 8 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35479                Number of obs =   224708
                                                      F(  3, 35478) =     1.56
                                                      Prob > F      =   0.1965
Total (centered) SS     =  76343728.34                Centered R2   =  -0.0001
Total (uncentered) SS   =  76343728.34                Uncentered R2 =  -0.0001
Residual SS             =  76350941.93                Root MSE      =    18.43

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   2.242522   4.036885     0.56   0.579    -5.669896    10.15494
        var5 |   1.158292   4.780738     0.24   0.809    -8.212103    10.52869
        var4 |   -1.85033   3.439417    -0.54   0.591    -8.591694    4.891034
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            231.086
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):             1854.151
                         (Kleibergen-Paap rk Wald F statistic):        123.431
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------------+
       Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------------+---------------------------------------|
   firm_id#user_id |     42710       42710           0    *|
                yh |        11           1          10     |
-----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. 
. //-------------------------------------------------------------
. //  Firm + year FE ("fyh")
. //-------------------------------------------------------------
. local feopt "absorb(firm_id yh)"

. local tag   "fyh"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=fyh)
   – outcome: total_contributions_q100
(dropped 71 singleton observations)
(MWFE estimator converged in 5 iterations)

HDFE Linear regression                            Number of obs   =    231,234
Absorbing 2 HDFE groups                           F(   3,  37159) =       2.61
Statistics robust to heteroskedasticity           Prob > F        =     0.0499
                                                  R-squared       =     0.1607
                                                  Adj R-squared   =     0.1527
                                                  Within R-sq.    =     0.0000
Number of clusters (user_id) =     37,160         Root MSE        =    25.6126

                           (Std. err. adjusted for 37,160 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   .0050692   .4602434     0.01   0.991    -.8970206     .907159
        var5 |   1.770334   1.030819     1.72   0.086    -.2500999    3.790768
        var4 |  -2.063829   .8908436    -2.32   0.021    -3.809907   -.3177508
       _cons |   76.61914   .1658313   462.03   0.000     76.29411    76.94418
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2153           0        2153     |
          yh |        11           1          10     |
-----------------------------------------------------+
(dropped 71 singleton observations)
(MWFE estimator converged in 5 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   37160                Number of obs =   231234
                                                      F(  3, 37159) =     1.89
                                                      Prob > F      =   0.1286
Total (centered) SS     =  150274738.2                Centered R2   =  -0.0000
Total (uncentered) SS   =  150274738.2                Uncentered R2 =  -0.0000
Residual SS             =  150280316.9                Root MSE      =    25.61

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   1.531758   4.065686     0.38   0.706    -6.437099    9.500615
        var5 |   1.609625   4.992231     0.32   0.747    -8.175287    11.39454
        var4 |  -2.227263   3.630542    -0.61   0.540    -9.343225      4.8887
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            354.579
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):             1892.832
                         (Kleibergen-Paap rk Wald F statistic):        187.113
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2153           0        2153     |
          yh |        11           1          10     |
-----------------------------------------------------+
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. local feopt "absorb(user_id yh)"

. local tag   "useryh"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=useryh)
   – outcome: total_contributions_q100
(dropped 1392 singleton observations)
(MWFE estimator converged in 7 iterations)

HDFE Linear regression                            Number of obs   =    229,913
Absorbing 2 HDFE groups                           F(   3,  35793) =      33.73
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.4884
                                                  Adj R-squared   =     0.3940
                                                  Within R-sq.    =     0.0008
Number of clusters (user_id) =     35,794         Root MSE        =    21.7128

                           (Std. err. adjusted for 35,794 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   1.875668   .4620782     4.06   0.000     .9699808    2.781355
        var5 |  -.0211048   1.123972    -0.02   0.985    -2.224123    2.181914
        var4 |   2.275435   .9768885     2.33   0.020     .3607035    4.190166
       _cons |    75.7353   .1412325   536.25   0.000     75.45848    76.01212
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     user_id |     35794       35794           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 1392 singleton observations)
(MWFE estimator converged in 8 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35794                Number of obs =   229913
                                                      F(  3, 35793) =    36.15
                                                      Prob > F      =   0.0000
Total (centered) SS     =  91580642.98                Centered R2   =  -0.0161
Total (uncentered) SS   =  91580642.98                Uncentered R2 =  -0.0161
Residual SS             =  93054385.58                Root MSE      =    20.12

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   22.80691   4.109818     5.55   0.000     14.75154    30.86228
        var5 |  -24.72366   5.286675    -4.68   0.000     -35.0857   -14.36161
        var4 |   19.21747   3.930327     4.89   0.000     11.51391    26.92102
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            301.177
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):             1931.537
                         (Kleibergen-Paap rk Wald F statistic):        161.515
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     user_id |     35794       35794           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. //-------------------------------------------------------------
. // Time FE ("time")
. //-------------------------------------------------------------
. local feopt "absorb(yh)"

. local tag   "time"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3. 
.         gen var8 = remote * startup
  4.         gen var9 = teleworkable*startup
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7.         
.     display as text ">> FE spec: time  (tag=`tag')"
  8.     display as text "   – outcome: `y'"
  9. 
.     // OLS
.     reghdfe `y' var3 var5 var4 remote startup var8 covid, ///
>         `feopt' vce(cluster user_id)
 10.         local N   = e(N)
 11.         
.     foreach p in var3 var5 var4 {
 12.         local b    = _b[`p']
 13.         local se   = _se[`p']
 14.         local t    = `b'/`se'
 15.         local pval = 2*ttail(e(df_r), abs(`t'))
 16. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 17.     }
 18. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 var8 remote = var6 var7 var9 teleworkable) var4 startup covid, ///
>         `feopt' vce(cluster user_id) savefirst
 19.                 
.     local rkf = e(rkf)
 20.         local N   = e(N)
 21.         
.     foreach p in var3 var5 var4 {
 22.         local b    = _b[`p']
 23.         local se   = _se[`p']
 24.         local t    = `b'/`se'
 25.         local pval = 2*ttail(e(df_r), abs(`t'))
 26.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 27.     }
 28. 
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 29.         local F3 = FS[4,1]
 30.         local F5 = FS[4,2]
 31. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 32.         local N_fs = e(N)
 33. 
.         foreach p in var6 var7 var4 {
 34.                 local b    = _b[`p']
 35.                 local se   = _se[`p']
 36.                 local t    = `b'/`se'
 37.                 local pval = 2*ttail(e(df_r), abs(`t'))
 38. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 39.         }
 40. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 41.         local N_fs = e(N)
 42. 
.         foreach p in var6 var7 var4 {
 43.                 local b    = _b[`p']
 44.                 local se   = _se[`p']
 45.                 local t    = `b'/`se'
 46.                 local pval = 2*ttail(e(df_r), abs(`t'))
 47. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 48.         }
 49. 
. }
(15,194 missing values generated)
>> FE spec: time  (tag=time)
   – outcome: total_contributions_q100
(MWFE estimator converged in 1 iterations)
note: covid is probably collinear with the fixed effects (all partialled-out values are close to zero; tol = 1.0e-09)

HDFE Linear regression                            Number of obs   =    231,305
Absorbing 1 HDFE group                            F(   6,  37185) =     518.96
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.0572
                                                  Adj R-squared   =     0.0571
                                                  Within R-sq.    =     0.0294
Number of clusters (user_id) =     37,186         Root MSE        =    27.0230

                           (Std. err. adjusted for 37,186 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   .5684576   .4867958     1.17   0.243    -.3856756    1.522591
        var5 |    1.75726   1.111431     1.58   0.114    -.4211747    3.935696
        var4 |  -2.472984   .9643099    -2.56   0.010    -4.363058   -.5829093
      remote |   6.942174   .4096125    16.95   0.000     6.139322    7.745025
     startup |    15.2355   .7288642    20.90   0.000     13.80691     16.6641
        var8 |  -6.301659   .8503361    -7.41   0.000    -7.968342   -4.634977
       covid |          0  (omitted)
       _cons |   69.77564   .2817511   247.65   0.000      69.2234    70.32788
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
          yh |        11           0          11     |
-----------------------------------------------------+
(MWFE estimator converged in 1 iterations)

Stored estimation results
-------------------------
-----------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+---------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          7  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          7  First-stage regression: var5
_ivreg2_var8 | ivreg2         var8          7  First-stage regression: var8
_ivreg2_re~e | ivreg2       remote          7  First-stage regression: remote
-----------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35717                Number of obs =   216111
                                                      F(  6, 35716) =   219.48
                                                      Prob > F      =   0.0000
Total (centered) SS     =    161421891                Centered R2   = -39.2106
Total (uncentered) SS   =    161421891                Uncentered R2 = -39.2106
Residual SS             =   6490873207                Root MSE      =    173.3

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -113.2777   31.20129    -3.63   0.000    -174.4332   -52.12226
        var5 |   2195.204   3419.556     0.64   0.521     -4507.23    8897.638
        var8 |  -2274.308   3419.358    -0.67   0.506    -8976.354    4427.739
      remote |   188.1112   31.29422     6.01   0.000     126.7736    249.4488
        var4 |  -1849.818   2915.772    -0.63   0.526    -7564.819    3865.183
     startup |    1913.01   2915.599     0.66   0.512    -3801.653    7627.673
       covid |          0  (omitted)
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              0.377
                                                   Chi-sq(1) P-val =    0.5392
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):                1.605
                         (Kleibergen-Paap rk Wald F statistic):          0.094
Stock-Yogo weak ID test critical values:                       <not available>
------------------------------------------------------------------------------
Warning: estimated covariance matrix of moment conditions not of full rank.
         overidentification statistic not reported, and standard errors and
         model tests should be interpreted with caution.
Possible causes:
         number of clusters insufficient to calculate robust covariance matrix
         singleton dummy variable (dummy with one 1 and N-1 0s or vice versa)
partial option may address problem.
------------------------------------------------------------------------------
Collinearities detected among instruments: 1 instrument(s) dropped
Instrumented:         var3 var5 var8 remote
Included instruments: var4 startup covid
Excluded instruments: var6 var7 var9 teleworkable
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
          yh |        11           0          11     |
-----------------------------------------------------+
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. //-------------------------------------------------------------
. // Firm FE ("firm")
. //-------------------------------------------------------------
. local feopt "absorb(firm_id)"

. local tag   "firm"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3. 
.     display as text ">> FE spec: firm  (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4 covid, ///
>         `feopt' vce(cluster user_id)
  8.         
.         local N   = e(N)
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4 covid, ///
>         `feopt' vce(cluster user_id) savefirst
 17.                 
.     local rkf = e(rkf)
 18.         local N   = e(N)
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26. 
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: firm  (tag=firm)
   – outcome: total_contributions_q100
(dropped 71 singleton observations)
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =    231,234
Absorbing 1 HDFE group                            F(   4,  37159) =      72.95
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.1379
                                                  Adj R-squared   =     0.1298
                                                  Within R-sq.    =     0.0015
Number of clusters (user_id) =     37,160         Root MSE        =    25.9569

                           (Std. err. adjusted for 37,160 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   .2620468   .4652837     0.56   0.573    -.6499223    1.174016
        var5 |    1.57165   1.039204     1.51   0.130    -.4652188    3.608519
        var4 |  -1.565963   .8984945    -1.74   0.081    -3.327037    .1951114
       covid |  -2.190856   .3486577    -6.28   0.000    -2.874235   -1.507477
       _cons |   77.49692   .0976541   793.59   0.000     77.30551    77.68832
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2153           0        2153     |
-----------------------------------------------------+
(dropped 71 singleton observations)
(MWFE estimator converged in 1 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          4  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          4  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   37160                Number of obs =   231234
                                                      F(  4, 37159) =    72.49
                                                      Prob > F      =   0.0000
Total (centered) SS     =  154578356.4                Centered R2   =   0.0013
Total (uncentered) SS   =  154578356.4                Uncentered R2 =   0.0013
Residual SS             =  154380679.7                Root MSE      =    25.96

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   3.237687     4.1248     0.78   0.432    -4.847035    11.32241
        var5 |   .4423758   5.043552     0.09   0.930    -9.443127    10.32788
        var4 |  -1.193674   3.662313    -0.33   0.744    -8.371909    5.984561
       covid |  -4.126831   2.703914    -1.53   0.127    -9.426578    1.172915
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            355.016
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):             1895.379
                         (Kleibergen-Paap rk Wald F statistic):        187.343
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4 covid
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2153           0        2153     |
-----------------------------------------------------+
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. //-------------------------------------------------------------
. // No FE ("none")
. //-------------------------------------------------------------
. local feopt ""

. local tag   "none"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.         
.         gen var8 = remote * startup
  4.     gen var9 = teleworkable*startup
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     display as text ">> FE spec: none  (tag=`tag')"
  8.     display as text "   – outcome: `y'"
  9. 
.     // OLS
.     reghdfe `y' var3 var5 var4 remote startup var8 covid, ///
>         absorb() vce(cluster user_id)
 10.                 
.         local N   = e(N)
 11.         
.     foreach p in var3 var5 var4 {
 12.         local b    = _b[`p']
 13.         local se   = _se[`p']
 14.         local t    = `b'/`se'
 15.         local pval = 2*ttail(e(df_r), abs(`t'))
 16. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 17.     }
 18. 
.     // IV (2nd stage)
.     ivreghdfe ///
>         `y' (var3 var5 var8 remote = var6 var7 var9 teleworkable) var4 startup covid, ///
>         absorb() vce(cluster user_id) savefirst
 19.     local rkf = e(rkf)
 20.         local N   = e(N)
 21.         
.     foreach p in var3 var5 var4 {
 22.         local b    = _b[`p']
 23.         local se   = _se[`p']
 24.         local t    = `b'/`se'
 25.         local pval = 2*ttail(e(df_r), abs(`t'))
 26.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 27.     }
 28. 
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 29.         local F3 = FS[4,1]
 30.         local F5 = FS[4,2]
 31. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 32.         local N_fs = e(N)
 33. 
.         foreach p in var6 var7 var4 {
 34.                 local b    = _b[`p']
 35.                 local se   = _se[`p']
 36.                 local t    = `b'/`se'
 37.                 local pval = 2*ttail(e(df_r), abs(`t'))
 38. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 39.         }
 40. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 41.         local N_fs = e(N)
 42. 
.         foreach p in var6 var7 var4 {
 43.                 local b    = _b[`p']
 44.                 local se   = _se[`p']
 45.                 local t    = `b'/`se'
 46.                 local pval = 2*ttail(e(df_r), abs(`t'))
 47. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 48.         }
 49. 
. }
(15,194 missing values generated)
>> FE spec: none  (tag=none)
   – outcome: total_contributions_q100
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =    231,305
Absorbing 1 HDFE group                            F(   7,  37185) =     476.87
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.0304
                                                  Adj R-squared   =     0.0303
                                                  Within R-sq.    =     0.0304
Number of clusters (user_id) =     37,186         Root MSE        =    27.4043

                           (Std. err. adjusted for 37,186 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   .8484727   .4916319     1.73   0.084    -.1151394    1.812085
        var5 |   1.552023     1.1199     1.39   0.166    -.6430129    3.747059
        var4 |  -2.027893   .9721338    -2.09   0.037    -3.933302   -.1224837
      remote |   6.944621   .4093942    16.96   0.000     6.142197    7.747045
     startup |   15.30079   .7286911    21.00   0.000     13.87253    16.72904
        var8 |  -6.347886   .8500048    -7.47   0.000    -8.013919   -4.681853
       covid |  -2.360368   .3650497    -6.47   0.000    -3.075875    -1.64486
       _cons |   70.72142   .2997602   235.93   0.000     70.13388    71.30896
------------------------------------------------------------------------------

Stored estimation results
-------------------------
-----------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+---------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          8  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          8  First-stage regression: var5
_ivreg2_var8 | ivreg2         var8          8  First-stage regression: var8
_ivreg2_re~e | ivreg2       remote          8  First-stage regression: remote
-----------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35717                Number of obs =   216111
                                                      F(  7, 35716) =   194.26
                                                      Prob > F      =   0.0000
Total (centered) SS     =  166169421.2                Centered R2   = -38.0994
Total (uncentered) SS   =   1437539747                Uncentered R2 =  -3.5196
Residual SS             =   6497123133                Root MSE      =    173.4

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   -108.622   30.78795    -3.53   0.000    -168.9652   -48.27871
        var5 |   2192.397   3398.885     0.65   0.519    -4469.296     8854.09
        var8 |  -2273.069   3398.689    -0.67   0.504    -8934.377    4388.238
      remote |   185.5217   30.85976     6.01   0.000     125.0376    246.0057
        var4 |  -1847.896    2898.88    -0.64   0.524    -7529.595    3833.804
     startup |   1912.351   2898.707     0.66   0.509    -3769.011    7593.713
       covid |   68.43143   19.96982     3.43   0.001      29.2913    107.5716
       _cons |  -45.05451   20.00137    -2.25   0.024    -84.25646   -5.852549
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              0.381
                                                   Chi-sq(1) P-val =    0.5371
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):                1.622
                         (Kleibergen-Paap rk Wald F statistic):          0.095
Stock-Yogo weak ID test critical values:                       <not available>
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5 var8 remote
Included instruments: var4 startup covid
Excluded instruments: var6 var7 var9 teleworkable
------------------------------------------------------------------------------
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. local feopt "absorb(firm_id user_id industry_id#yh)"

. local tag   "industrytime"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=industrytime)
   – outcome: total_contributions_q100
(dropped 1449 singleton observations)
(MWFE estimator converged in 83 iterations)

HDFE Linear regression                            Number of obs   =    227,829
Absorbing 3 HDFE groups                           F(   3,  35527) =       3.72
Statistics robust to heteroskedasticity           Prob > F        =     0.0109
                                                  R-squared       =     0.5126
                                                  Adj R-squared   =     0.4155
                                                  Within R-sq.    =     0.0001
Number of clusters (user_id) =     35,528         Root MSE        =    21.3486

                           (Std. err. adjusted for 35,528 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -.0504259   .4638168    -0.11   0.913     -.959521    .8586692
        var5 |   3.472225   1.121199     3.10   0.002     1.274641    5.669809
        var4 |  -2.934078   .9908402    -2.96   0.003    -4.876156   -.9920012
       _cons |     76.495   .1406651   543.81   0.000      76.2193    76.77071
------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
          firm_id |      2129           1        2128     |
          user_id |     35528       35528           0    *|
   industry_id#yh |       198          18         180     |
----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 1449 singleton observations)
(MWFE estimator converged in 83 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35528                Number of obs =   227829
                                                      F(  3, 35527) =     1.51
                                                      Prob > F      =   0.2098
Total (centered) SS     =     86595752                Centered R2   =  -0.0038
Total (uncentered) SS   =     86595752                Uncentered R2 =  -0.0038
Residual SS             =  86928951.32                Root MSE      =    19.63

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   10.68652   5.436205     1.97   0.049     .0313905    21.34165
        var5 |  -3.346171   4.679626    -0.72   0.475    -12.51838    5.826039
        var4 |   .5366997   3.382359     0.16   0.874    -6.092828    7.166227
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            210.978
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):             1001.475
                         (Kleibergen-Paap rk Wald F statistic):        109.157
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
          firm_id |      2129           1        2128     |
          user_id |     35528       35528           0    *|
   industry_id#yh |       198          18         180     |
----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. local feopt "absorb(firm_id user_id msa_id#yh)"

. local tag   "msatime"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=msatime)
   – outcome: total_contributions_q100
(dropped 2262 singleton observations)
(MWFE estimator converged in 96 iterations)

HDFE Linear regression                            Number of obs   =    229,043
Absorbing 3 HDFE groups                           F(   3,  35716) =       4.34
Statistics robust to heteroskedasticity           Prob > F        =     0.0046
                                                  R-squared       =     0.5184
                                                  Adj R-squared   =     0.4164
                                                  Within R-sq.    =     0.0001
Number of clusters (user_id) =     35,717         Root MSE        =    21.3095

                           (Std. err. adjusted for 35,717 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   .3094679   .4768295     0.65   0.516    -.6251324    1.244068
        var5 |   3.066401   1.068638     2.87   0.004     .9718386    5.160963
        var4 |  -2.538893   .9301707    -2.73   0.006    -4.362056   -.7157305
       _cons |    76.4262   .1457308   524.43   0.000     76.14056    76.71184
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2148           1        2147     |
     user_id |     35717       35717           0    *|
   msa_id#yh |      2168           1        2167     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 2262 singleton observations)
(MWFE estimator converged in 96 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35717                Number of obs =   229043
                                                      F(  3, 35716) =     1.20
                                                      Prob > F      =   0.3076
Total (centered) SS     =  85834042.19                Centered R2   =  -0.0003
Total (uncentered) SS   =  85834042.19                Uncentered R2 =  -0.0003
Residual SS             =  85862183.42                Root MSE      =    19.55

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |    3.83465   4.302725     0.89   0.373    -4.598822    12.26812
        var5 |   .3912133   5.413987     0.07   0.942    -10.22037    11.00279
        var4 |  -.9275899   3.947847    -0.23   0.814    -8.665491    6.810311
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            250.628
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):             1728.410
                         (Kleibergen-Paap rk Wald F statistic):        130.484
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      2148           1        2147     |
     user_id |     35717       35717           0    *|
   msa_id#yh |      2168           1        2167     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. 
. local feopt "absorb(firm_id user_id msa_id#industry_id#yh)"

. local tag   "msaindustrytime"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_${user_panel_variant}.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=msaindustrytime)
   – outcome: total_contributions_q100
(dropped 6411 singleton observations)
(MWFE estimator converged in 140 iterations)

HDFE Linear regression                            Number of obs   =    222,867
Absorbing 3 HDFE groups                           F(   3,  35000) =       3.26
Statistics robust to heteroskedasticity           Prob > F        =     0.0206
                                                  R-squared       =     0.5334
                                                  Adj R-squared   =     0.4211
                                                  Within R-sq.    =     0.0001
Number of clusters (user_id) =     35,001         Root MSE        =    21.2497

                           (Std. err. adjusted for 35,001 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   .2977955   .5142619     0.58   0.563    -.7101742    1.305765
        var5 |   2.525327   1.207094     2.09   0.036     .1593841    4.891269
        var4 |  -1.739284   1.069778    -1.63   0.104    -3.836083     .357515
       _cons |   76.34123   .1567902   486.90   0.000     76.03392    76.64855
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-------------------------------------------------------------------+
               Absorbed FE | Categories  - Redundant  = Num. Coefs |
---------------------------+---------------------------------------|
                   firm_id |      2065           1        2064     |
                   user_id |     35001       35001           0    *|
     msa_id#industry_id#yh |      6211          28        6183     |
-------------------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 6411 singleton observations)
(MWFE estimator converged in 140 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =   35001                Number of obs =   222867
                                                      F(  3, 35000) =     1.31
                                                      Prob > F      =   0.2707
Total (centered) SS     =  81110345.39                Centered R2   =  -0.0020
Total (uncentered) SS   =  81110345.39                Uncentered R2 =  -0.0020
Residual SS             =  81276215.47                Root MSE      =    19.46

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   8.989937   8.331822     1.08   0.281    -7.340699    25.32057
        var5 |  -4.774801   6.463574    -0.74   0.460    -17.44361    7.894009
        var4 |   2.724941   4.562032     0.60   0.550    -6.216786    11.66667
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):            101.404
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              494.193
                         (Kleibergen-Paap rk Wald F statistic):         49.489
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-------------------------------------------------------------------+
               Absorbed FE | Categories  - Redundant  = Num. Coefs |
---------------------------+---------------------------------------|
                   firm_id |      2065           1        2064     |
                   user_id |     35001       35001           0    *|
     msa_id#industry_id#yh |      6211          28        6183     |
-------------------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. 
. //-------------------------------------------------------------
. // Close & export CSV
. //-------------------------------------------------------------
. postclose handle

. use `out', clear

. export delimited using "`result_dir'/consolidated_results.csv", ///
>     replace delimiter(",") quote
file ../results/raw/user_productivity_alternative_fe_precovid/consolidated_results.csv saved

.         
. *------------------------------------------------------------
. *  Write first-stage CSV to disk
. *------------------------------------------------------------
. postclose handle_fs

. use `out_fs', clear

. export delimited using "`result_dir'/first_stage_fstats.csv", ///
>         replace delimiter(",") quote
file ../results/raw/user_productivity_alternative_fe_precovid/first_stage_fstats.csv saved

.                 
. 
. display as result "→ main CSV       : `result_dir'/consolidated_results.csv"
→ main CSV       : ../results/raw/user_productivity_alternative_fe_precovid/consolidated_results.csv

. display as result "→ first-stage CSV: `result_dir'/first_stage_fstats.csv"
→ first-stage CSV: ../results/raw/user_productivity_alternative_fe_precovid/first_stage_fstats.csv

. 
. log close
      name:  <unnamed>
       log:  /Users/saul/Dropbox/Remote Work Startups/main/spec/log/user_productivity_alternative_fe_precovid.log
  log type:  text
 closed on:   5 Jun 2025, 20:35:09
-----------------------------------------------------------------------------------------------------------------------------------------
