-----------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/saul/Dropbox/Remote Work Startups/main/spec/log/user_productivity_alternative_fe_balanced_pre.log
  log type:  text
 opened on:  11 Jun 2025, 08:38:42

. 
. // 0) Setup environment
. do "../src/globals.do"

. global raw_data "../data/raw"

. global processed_data  "../data/processed"

. global results "../results/raw"

. global clean_results "../results/cleaned"

. 
. 
. 
. 
. 
end of do-file

. 
. // 1) Common settings
. local result_dir "$results/`specname'"

. capture mkdir "`result_dir'"

. 
. local outcomes total_contributions_q100 

. // restricted_contributions_q100
. 
. *--- main results -------------------------------------------------------------
. tempfile out  

. capture postclose handle

. postfile handle ///
>     str20   model_type          ///
>     str20   fe_tag              ///
>     str40  outcome             ///
>     str40  param               ///
>     double coef se pval pre_mean ///
>     double rkf nobs            ///
>     using `out', replace
(file /var/folders/hg/s3xm9w393gxby64_zklmhgbc0000gn/T//S_71501.000001 not found)

. 
. 
. *--- first-stage results (coefficients + diagnostics) -------------------------
. tempfile out_fs

. capture postclose handle_fs

. postfile handle_fs ///
>     str20   fe_tag              ///  "fyh", "time", "firm", "none"
>     str40  outcome             ///
>     str20   endovar             ///  "var3" / "var5"
>     str40  param               ///  var6 / var7 / var4
>     double coef se pval        ///
>     double partialF rkf nobs   ///
>     using `out_fs', replace
(file /var/folders/hg/s3xm9w393gxby64_zklmhgbc0000gn/T//S_71501.000002 not found)

. 
.         
. //-------------------------------------------------------------
. // Firm + user + year FE ("fyh")
. //-------------------------------------------------------------
. local feopt "absorb(firm_id user_id yh)"

. local tag   "fyhu"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=fyhu)
   – outcome: total_contributions_q100
(dropped 25 singleton observations)
(MWFE estimator converged in 106 iterations)

HDFE Linear regression                            Number of obs   =     52,995
Absorbing 3 HDFE groups                           F(   3,   4819) =      19.81
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.7042
                                                  Adj R-squared   =     0.6669
                                                  Within R-sq.    =     0.0039
Number of clusters (user_id) =      4,820         Root MSE        =    16.8281

                            (Std. err. adjusted for 4,820 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -2.657995   .9855688    -2.70   0.007     -4.59016   -.7258303
        var5 |   9.178957   2.686348     3.42   0.001     3.912488    14.44543
        var4 |  -12.00981   2.334944    -5.14   0.000    -16.58736   -7.432249
       _cons |   51.52695   .3105467   165.92   0.000     50.91814    52.13577
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1113           1        1112     |
     user_id |      4820        4820           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 25 singleton observations)
(MWFE estimator converged in 106 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4820                Number of obs =    52995
                                                      F(  3,  4819) =    16.45
                                                      Prob > F      =   0.0000
Total (centered) SS     =  13375398.91                Centered R2   =  -0.0113
Total (uncentered) SS   =  13375398.91                Uncentered R2 =  -0.0113
Residual SS             =   13526917.3                Root MSE      =    16.15

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -17.35999   8.716362    -1.99   0.046    -34.44804   -.2719426
        var5 |   31.84583   12.28309     2.59   0.010     7.765368     55.9263
        var4 |  -28.78591   9.542423    -3.02   0.003    -47.49342   -10.07841
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             49.502
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              397.675
                         (Kleibergen-Paap rk Wald F statistic):         26.054
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1113           1        1112     |
     user_id |      4820        4820           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. //-------------------------------------------------------------
. // firm x user + yh
. //-------------------------------------------------------------
. local feopt "absorb(firm_id#user_id yh)"

. local tag   "firmbyuseryh"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=firmbyuseryh)
   – outcome: total_contributions_q100
(dropped 302 singleton observations)
(MWFE estimator converged in 6 iterations)

HDFE Linear regression                            Number of obs   =     52,718
Absorbing 2 HDFE groups                           F(   3,   4819) =      22.79
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.7195
                                                  Adj R-squared   =     0.6836
                                                  Within R-sq.    =     0.0046
Number of clusters (user_id) =      4,820         Root MSE        =    16.4022

                            (Std. err. adjusted for 4,820 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -2.792291   .9859502    -2.83   0.005    -4.725203   -.8593786
        var5 |   9.773256   2.682665     3.64   0.000     4.514007     15.0325
        var4 |  -12.85105   2.333083    -5.51   0.000    -17.42495   -8.277139
       _cons |    51.6552   .3105077   166.36   0.000     51.04646    52.26394
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------------+
       Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------------+---------------------------------------|
   firm_id#user_id |      5980        5980           0    *|
                yh |        11           1          10     |
-----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 302 singleton observations)
(MWFE estimator converged in 6 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4820                Number of obs =    52718
                                                      F(  3,  4819) =    18.97
                                                      Prob > F      =   0.0000
Total (centered) SS     =  12628633.21                Centered R2   =  -0.0149
Total (uncentered) SS   =  12628633.21                Uncentered R2 =  -0.0149
Residual SS             =  12816907.26                Root MSE      =    15.59

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -19.29558   8.792483    -2.19   0.028    -36.53286   -2.058304
        var5 |   33.66757   12.31548     2.73   0.006     9.523614    57.81152
        var4 |   -30.3495   9.563901    -3.17   0.002    -49.09911   -11.59989
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             47.587
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              407.653
                         (Kleibergen-Paap rk Wald F statistic):         25.601
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------------+
       Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------------+---------------------------------------|
   firm_id#user_id |      5980        5980           0    *|
                yh |        11           1          10     |
-----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. 
. //-------------------------------------------------------------
. //  Firm + year FE ("fyh")
. //-------------------------------------------------------------
. local feopt "absorb(firm_id yh)"

. local tag   "fyh"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=fyh)
   – outcome: total_contributions_q100
(dropped 25 singleton observations)
(MWFE estimator converged in 5 iterations)

HDFE Linear regression                            Number of obs   =     52,995
Absorbing 2 HDFE groups                           F(   3,   4819) =      14.69
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.2972
                                                  Adj R-squared   =     0.2819
                                                  Within R-sq.    =     0.0014
Number of clusters (user_id) =      4,820         Root MSE        =    24.7067

                            (Std. err. adjusted for 4,820 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   -2.37665   1.011596    -2.35   0.019     -4.35984    -.393461
        var5 |   6.201553   2.822268     2.20   0.028     .6686183    11.73449
        var4 |  -9.210662   2.470566    -3.73   0.000     -14.0541   -4.367226
       _cons |   51.41502   .4153982   123.77   0.000     50.60065    52.22939
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1113           0        1113     |
          yh |        11           1          10     |
-----------------------------------------------------+
(dropped 25 singleton observations)
(MWFE estimator converged in 5 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4820                Number of obs =    52995
                                                      F(  3,  4819) =    14.26
                                                      Prob > F      =   0.0000
Total (centered) SS     =  31707490.71                Centered R2   =  -0.0078
Total (uncentered) SS   =  31707490.71                Uncentered R2 =  -0.0078
Residual SS             =  31954109.95                Root MSE      =    24.82

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -18.75911   9.011748    -2.08   0.037    -36.42624   -1.091968
        var5 |   38.30184   13.01588     2.94   0.003     12.78477    63.81891
        var4 |  -33.84446     10.198    -3.32   0.001    -53.83721   -13.85172
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             52.065
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              379.911
                         (Kleibergen-Paap rk Wald F statistic):         27.408
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1113           0        1113     |
          yh |        11           1          10     |
-----------------------------------------------------+
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. local feopt "absorb(user_id yh)"

. local tag   "useryh"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=useryh)
   – outcome: total_contributions_q100
(MWFE estimator converged in 2 iterations)

HDFE Linear regression                            Number of obs   =     53,020
Absorbing 2 HDFE groups                           F(   3,   4819) =       1.17
Statistics robust to heteroskedasticity           Prob > F        =     0.3215
                                                  R-squared       =     0.6681
                                                  Adj R-squared   =     0.6348
                                                  Within R-sq.    =     0.0003
Number of clusters (user_id) =      4,820         Root MSE        =    17.6199

                            (Std. err. adjusted for 4,820 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -.8338197   .9934251    -0.84   0.401    -2.781386    1.113747
        var5 |   2.297311     2.9707     0.77   0.439    -3.526616    8.121238
        var4 |  -2.988488   2.641231    -1.13   0.258    -8.166506     2.18953
       _cons |   50.63368   .3138623   161.32   0.000     50.01837    51.24899
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     user_id |      4820        4820           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(MWFE estimator converged in 2 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4820                Number of obs =    53020
                                                      F(  3,  4819) =     1.32
                                                      Prob > F      =   0.2672
Total (centered) SS     =  14964255.57                Centered R2   =  -0.0026
Total (uncentered) SS   =  14964255.57                Uncentered R2 =  -0.0026
Residual SS             =  15003038.97                Root MSE      =    16.82

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |   4.552932   8.463813     0.54   0.591       -12.04    21.14587
        var5 |   6.173844   13.26334     0.47   0.642    -19.82836    32.17605
        var4 |  -7.399757   10.63781    -0.70   0.487    -28.25473    13.45521
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             55.328
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              422.640
                         (Kleibergen-Paap rk Wald F statistic):         29.955
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     user_id |      4820        4820           0    *|
          yh |        11           1          10     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. //-------------------------------------------------------------
. // Time FE ("time")
. //-------------------------------------------------------------
. local feopt "absorb(yh)"

. local tag   "time"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3. 
.         gen var8 = remote * startup
  4.         gen var9 = teleworkable*startup
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7.         
.     display as text ">> FE spec: time  (tag=`tag')"
  8.     display as text "   – outcome: `y'"
  9. 
.     // OLS
.     reghdfe `y' var3 var5 var4 remote startup var8 covid, ///
>         `feopt' vce(cluster user_id)
 10.         local N   = e(N)
 11.         
.     foreach p in var3 var5 var4 {
 12.         local b    = _b[`p']
 13.         local se   = _se[`p']
 14.         local t    = `b'/`se'
 15.         local pval = 2*ttail(e(df_r), abs(`t'))
 16. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 17.     }
 18. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 var8 remote = var6 var7 var9 teleworkable) var4 startup covid, ///
>         `feopt' vce(cluster user_id) savefirst
 19.                 
.     local rkf = e(rkf)
 20.         local N   = e(N)
 21.         
.     foreach p in var3 var5 var4 {
 22.         local b    = _b[`p']
 23.         local se   = _se[`p']
 24.         local t    = `b'/`se'
 25.         local pval = 2*ttail(e(df_r), abs(`t'))
 26.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 27.     }
 28. 
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 29.         local F3 = FS[4,1]
 30.         local F5 = FS[4,2]
 31. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 32.         local N_fs = e(N)
 33. 
.         foreach p in var6 var7 var4 {
 34.                 local b    = _b[`p']
 35.                 local se   = _se[`p']
 36.                 local t    = `b'/`se'
 37.                 local pval = 2*ttail(e(df_r), abs(`t'))
 38. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 39.         }
 40. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 41.         local N_fs = e(N)
 42. 
.         foreach p in var6 var7 var4 {
 43.                 local b    = _b[`p']
 44.                 local se   = _se[`p']
 45.                 local t    = `b'/`se'
 46.                 local pval = 2*ttail(e(df_r), abs(`t'))
 47. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 48.         }
 49. 
. }
(3,733 missing values generated)
>> FE spec: time  (tag=time)
   – outcome: total_contributions_q100
(MWFE estimator converged in 1 iterations)
note: covid is probably collinear with the fixed effects (all partialled-out values are close to zero; tol = 1.0e-09)

HDFE Linear regression                            Number of obs   =     53,020
Absorbing 1 HDFE group                            F(   6,   4819) =      78.89
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.0482
                                                  Adj R-squared   =     0.0479
                                                  Within R-sq.    =     0.0482
Number of clusters (user_id) =      4,820         Root MSE        =    28.4486

                            (Std. err. adjusted for 4,820 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |    -1.2858   1.048337    -1.23   0.220    -3.341019    .7694192
        var5 |   2.748451    2.92224     0.94   0.347    -2.980472    8.477375
        var4 |  -6.905569   2.568866    -2.69   0.007    -11.94172   -1.869419
      remote |   9.733899   1.323621     7.35   0.000     7.138997     12.3288
     startup |   24.59477   2.803278     8.77   0.000     19.09907    30.09048
        var8 |  -11.42129   3.199212    -3.57   0.000    -17.69321   -5.149377
       covid |          0  (omitted)
       _cons |    41.1741   .9172804    44.89   0.000     39.37582    42.97239
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
          yh |        11           0          11     |
-----------------------------------------------------+
(MWFE estimator converged in 1 iterations)

Stored estimation results
-------------------------
-----------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+---------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          7  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          7  First-stage regression: var5
_ivreg2_var8 | ivreg2         var8          7  First-stage regression: var8
_ivreg2_re~e | ivreg2       remote          7  First-stage regression: remote
-----------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4646                Number of obs =    49287
                                                      F(  6,  4645) =    30.96
                                                      Prob > F      =   0.0000
Total (centered) SS     =  41664804.38                Centered R2   = -34.2321
Total (uncentered) SS   =  41664804.38                Uncentered R2 = -34.2321
Residual SS             =   1467937249                Root MSE      =    172.6

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -306.9648   247.3168    -1.24   0.215    -791.8231    177.8935
        var5 |   2264.899   4882.693     0.46   0.643    -7307.497     11837.3
        var8 |  -2349.763   4880.215    -0.48   0.630     -11917.3    7217.774
      remote |   388.3763   249.7471     1.56   0.120    -101.2467    877.9993
        var4 |  -1905.926   4227.846    -0.45   0.652    -10194.51    6382.659
     startup |   1975.793   4225.599     0.47   0.640    -6308.387    10259.97
       covid |          0  (omitted)
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              0.168
                                                   Chi-sq(1) P-val =    0.6819
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):                0.854
                         (Kleibergen-Paap rk Wald F statistic):          0.042
Stock-Yogo weak ID test critical values:                       <not available>
------------------------------------------------------------------------------
Warning: estimated covariance matrix of moment conditions not of full rank.
         overidentification statistic not reported, and standard errors and
         model tests should be interpreted with caution.
Possible causes:
         number of clusters insufficient to calculate robust covariance matrix
         singleton dummy variable (dummy with one 1 and N-1 0s or vice versa)
partial option may address problem.
------------------------------------------------------------------------------
Collinearities detected among instruments: 1 instrument(s) dropped
Instrumented:         var3 var5 var8 remote
Included instruments: var4 startup covid
Excluded instruments: var6 var7 var9 teleworkable
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
          yh |        11           0          11     |
-----------------------------------------------------+
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. //-------------------------------------------------------------
. // Firm FE ("firm")
. //-------------------------------------------------------------
. local feopt "absorb(firm_id)"

. local tag   "firm"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3. 
.     display as text ">> FE spec: firm  (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4 covid, ///
>         `feopt' vce(cluster user_id)
  8.         
.         local N   = e(N)
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4 covid, ///
>         `feopt' vce(cluster user_id) savefirst
 17.                 
.     local rkf = e(rkf)
 18.         local N   = e(N)
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26. 
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: firm  (tag=firm)
   – outcome: total_contributions_q100
(dropped 25 singleton observations)
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =     52,995
Absorbing 1 HDFE group                            F(   4,   4819) =      12.10
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.2971
                                                  Adj R-squared   =     0.2820
                                                  Within R-sq.    =     0.0016
Number of clusters (user_id) =      4,820         Root MSE        =    24.7054

                            (Std. err. adjusted for 4,820 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -2.375944   1.011453    -2.35   0.019    -4.358854   -.3930341
        var5 |   6.193229   2.821989     2.19   0.028     .6608432    11.72562
        var4 |  -9.191507   2.470346    -3.72   0.000    -14.03451   -4.348501
       covid |   1.879939   .7601317     2.47   0.013     .3897339    3.370144
       _cons |   50.55911   .2895121   174.64   0.000     49.99153    51.12668
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1113           0        1113     |
-----------------------------------------------------+
(dropped 25 singleton observations)
(MWFE estimator converged in 1 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          4  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          4  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4820                Number of obs =    52995
                                                      F(  4,  4819) =    11.75
                                                      Prob > F      =   0.0000
Total (centered) SS     =  31713572.19                Centered R2   =  -0.0076
Total (uncentered) SS   =  31713572.19                Uncentered R2 =  -0.0076
Residual SS             =  31955912.96                Root MSE      =    24.82

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -18.75278   9.010935    -2.08   0.037    -36.41833   -1.087237
        var5 |   38.27854   13.01377     2.94   0.003      12.7656    63.79147
        var4 |  -33.81319   10.19638    -3.32   0.001    -53.80275   -13.82363
       covid |   12.87455   6.071996     2.12   0.034     .9706709    24.77844
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             52.058
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              379.925
                         (Kleibergen-Paap rk Wald F statistic):         27.409
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4 covid
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1113           0        1113     |
-----------------------------------------------------+
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. //-------------------------------------------------------------
. // No FE ("none")
. //-------------------------------------------------------------
. local feopt ""

. local tag   "none"

. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.         
.         gen var8 = remote * startup
  4.     gen var9 = teleworkable*startup
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     display as text ">> FE spec: none  (tag=`tag')"
  8.     display as text "   – outcome: `y'"
  9. 
.     // OLS
.     reghdfe `y' var3 var5 var4 remote startup var8 covid, ///
>         absorb() vce(cluster user_id)
 10.                 
.         local N   = e(N)
 11.         
.     foreach p in var3 var5 var4 {
 12.         local b    = _b[`p']
 13.         local se   = _se[`p']
 14.         local t    = `b'/`se'
 15.         local pval = 2*ttail(e(df_r), abs(`t'))
 16. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 17.     }
 18. 
.     // IV (2nd stage)
.     ivreghdfe ///
>         `y' (var3 var5 var8 remote = var6 var7 var9 teleworkable) var4 startup covid, ///
>         absorb() vce(cluster user_id) savefirst
 19.     local rkf = e(rkf)
 20.         local N   = e(N)
 21.         
.     foreach p in var3 var5 var4 {
 22.         local b    = _b[`p']
 23.         local se   = _se[`p']
 24.         local t    = `b'/`se'
 25.         local pval = 2*ttail(e(df_r), abs(`t'))
 26.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 27.     }
 28. 
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 29.         local F3 = FS[4,1]
 30.         local F5 = FS[4,2]
 31. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 32.         local N_fs = e(N)
 33. 
.         foreach p in var6 var7 var4 {
 34.                 local b    = _b[`p']
 35.                 local se   = _se[`p']
 36.                 local t    = `b'/`se'
 37.                 local pval = 2*ttail(e(df_r), abs(`t'))
 38. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 39.         }
 40. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 41.         local N_fs = e(N)
 42. 
.         foreach p in var6 var7 var4 {
 43.                 local b    = _b[`p']
 44.                 local se   = _se[`p']
 45.                 local t    = `b'/`se'
 46.                 local pval = 2*ttail(e(df_r), abs(`t'))
 47. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 48.         }
 49. 
. }
(3,733 missing values generated)
>> FE spec: none  (tag=none)
   – outcome: total_contributions_q100
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =     53,020
Absorbing 1 HDFE group                            F(   7,   4819) =      67.85
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.0482
                                                  Adj R-squared   =     0.0480
                                                  Within R-sq.    =     0.0482
Number of clusters (user_id) =      4,820         Root MSE        =    28.4466

                            (Std. err. adjusted for 4,820 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -1.287513   1.048243    -1.23   0.219    -3.342547    .7675205
        var5 |    2.74283   2.921875     0.94   0.348    -2.985379    8.471039
        var4 |  -6.901022   2.568437    -2.69   0.007    -11.93633   -1.865712
      remote |   9.733178   1.323461     7.35   0.000      7.13859    12.32777
     startup |   24.59201   2.802685     8.77   0.000     19.09747    30.08655
        var8 |   -11.4212   3.198622    -3.57   0.000    -17.69196   -5.150445
       covid |   1.521451   .7831773     1.94   0.052    -.0139337    3.056836
       _cons |   40.48419   .9763992    41.46   0.000        38.57    42.39838
------------------------------------------------------------------------------

Stored estimation results
-------------------------
-----------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+---------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          8  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          8  First-stage regression: var5
_ivreg2_var8 | ivreg2         var8          8  First-stage regression: var8
_ivreg2_re~e | ivreg2       remote          8  First-stage regression: remote
-----------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4646                Number of obs =    49287
                                                      F(  7,  4645) =    27.75
                                                      Prob > F      =   0.0000
Total (centered) SS     =  41665044.87                Centered R2   = -34.2426
Total (uncentered) SS   =    166888846                Uncentered R2 =  -7.7986
Residual SS             =   1468384684                Root MSE      =    172.6

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -306.4024   246.9265    -1.24   0.215    -790.3694    177.5647
        var5 |   2265.395   4881.208     0.46   0.643    -7301.597    11832.39
        var8 |  -2350.288   4878.731    -0.48   0.630    -11912.42    7211.848
      remote |   387.8464   249.3576     1.56   0.120    -100.8855    876.5782
        var4 |  -1906.452   4226.786    -0.45   0.652     -10190.8    6377.896
     startup |   1976.334    4224.54     0.47   0.640    -6303.612    10256.28
       covid |   205.5831   165.2863     1.24   0.214     -118.372    529.5383
       _cons |  -212.5448   166.9016    -1.27   0.203    -539.6659    114.5764
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              0.168
                                                   Chi-sq(1) P-val =    0.6818
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):                0.855
                         (Kleibergen-Paap rk Wald F statistic):          0.042
Stock-Yogo weak ID test critical values:                       <not available>
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5 var8 remote
Included instruments: var4 startup covid
Excluded instruments: var6 var7 var9 teleworkable
------------------------------------------------------------------------------
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. local feopt "absorb(firm_id user_id industry_id#yh)"

. local tag   "industrytime"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=industrytime)
   – outcome: total_contributions_q100
(dropped 26 singleton observations)
(MWFE estimator converged in 107 iterations)

HDFE Linear regression                            Number of obs   =     52,386
Absorbing 3 HDFE groups                           F(   3,   4767) =      16.50
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.7063
                                                  Adj R-squared   =     0.6680
                                                  Within R-sq.    =     0.0034
Number of clusters (user_id) =      4,768         Root MSE        =    16.8105

                            (Std. err. adjusted for 4,768 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -2.617648   1.009528    -2.59   0.010     -4.59679   -.6385064
        var5 |   8.407994   2.906987     2.89   0.004     2.708956    14.10703
        var4 |   -11.3305   2.581992    -4.39   0.000    -16.39239   -6.268602
       _cons |   51.40036    .316089   162.61   0.000     50.78068    52.02004
------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
          firm_id |      1101           1        1100     |
          user_id |      4768        4768           0    *|
   industry_id#yh |       197          18         179     |
----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 26 singleton observations)
(MWFE estimator converged in 107 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4768                Number of obs =    52386
                                                      F(  3,  4767) =    13.88
                                                      Prob > F      =   0.0000
Total (centered) SS     =  13139129.75                Centered R2   =  -0.0602
Total (uncentered) SS   =  13139129.75                Uncentered R2 =  -0.0602
Residual SS             =  13929494.39                Root MSE      =    16.51

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -33.79178   13.69662    -2.47   0.014    -60.64348   -6.940088
        var5 |   31.15671   12.22724     2.55   0.011     7.185676    55.12774
        var4 |  -24.27001   9.668467    -2.51   0.012    -43.22467   -5.315349
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             33.091
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              186.183
                         (Kleibergen-Paap rk Wald F statistic):         16.944
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
----------------------------------------------------------+
      Absorbed FE | Categories  - Redundant  = Num. Coefs |
------------------+---------------------------------------|
          firm_id |      1101           1        1100     |
          user_id |      4768        4768           0    *|
   industry_id#yh |       197          18         179     |
----------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. local feopt "absorb(firm_id user_id msa_id#yh)"

. local tag   "msatime"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=msatime)
   – outcome: total_contributions_q100
(dropped 844 singleton observations)
(MWFE estimator converged in 119 iterations)

HDFE Linear regression                            Number of obs   =     52,176
Absorbing 3 HDFE groups                           F(   3,   4765) =      11.69
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.7146
                                                  Adj R-squared   =     0.6698
                                                  Within R-sq.    =     0.0023
Number of clusters (user_id) =      4,766         Root MSE        =    16.7584

                            (Std. err. adjusted for 4,766 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -2.521282   1.062393    -2.37   0.018    -4.604064   -.4384998
        var5 |   9.443837   2.797104     3.38   0.001     3.960222    14.92745
        var4 |  -11.07068   2.431276    -4.55   0.000     -15.8371   -6.304254
       _cons |   51.31957   .3358148   152.82   0.000     50.66122    51.97792
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1102           1        1101     |
     user_id |      4766        4766           0    *|
   msa_id#yh |      1216           2        1214     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 844 singleton observations)
(MWFE estimator converged in 119 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4766                Number of obs =    52176
                                                      F(  3,  4765) =     9.03
                                                      Prob > F      =   0.0000
Total (centered) SS     =  12693625.81                Centered R2   =  -0.0160
Total (uncentered) SS   =  12693625.81                Uncentered R2 =  -0.0160
Residual SS             =  12896568.53                Root MSE      =    16.08

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -19.42956   10.15959    -1.91   0.056    -39.34705    .4879291
        var5 |   38.26303   14.58055     2.62   0.009     9.678417    66.84764
        var4 |  -32.97135     11.324    -2.91   0.004    -55.17162   -10.77108
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             41.455
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              339.103
                         (Kleibergen-Paap rk Wald F statistic):         21.182
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     firm_id |      1102           1        1101     |
     user_id |      4766        4766           0    *|
   msa_id#yh |      1216           2        1214     |
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. 
. local feopt "absorb(firm_id user_id msa_id#industry_id#yh)"

. local tag   "msaindustrytime"

. 
. 
. foreach y of local outcomes {
  2.     use "$processed_data/user_panel_`panel_variant'.dta", clear
  3.     display as text ">> FE spec: (tag=`tag')"
  4.     display as text "   – outcome: `y'"
  5. 
.     summarize `y' if covid == 0, meanonly
  6.     local pre_mean = r(mean)
  7. 
.     // OLS
.      reghdfe `y' var3 var5 var4, ///
>         `feopt' vce(cluster user_id)
  8.                 
.         local N = e(N)  
  9.         
.     foreach p in var3 var5 var4 {
 10.         local b    = _b[`p']
 11.         local se   = _se[`p']
 12.         local t    = `b'/`se'
 13.         local pval = 2*ttail(e(df_r), abs(`t'))
 14. 
.                 post handle ("OLS") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (.) (`N')
 15.     }
 16. 
.     // IV (2nd stage)
.      ivreghdfe ///
>         `y' (var3 var5 = var6 var7) var4, ///
>         `feopt' vce(cluster user_id) savefirst
 17.     
.         local rkf = e(rkf)
 18.         local N = e(N)  
 19.         
.     foreach p in var3 var5 var4 {
 20.         local b    = _b[`p']
 21.         local se   = _se[`p']
 22.         local t    = `b'/`se'
 23.         local pval = 2*ttail(e(df_r), abs(`t'))
 24.                 post handle ("IV") ("`tag'") ("`y'") ("`p'") ///
>                                         (`b') (`se') (`pval') (`pre_mean') ///
>                                         (`rkf') (`N')
 25.     }
 26.         
.         *--- pull partial F's from the stacked matrix
.         matrix FS = e(first)
 27.         local F3 = FS[4,1]
 28.         local F5 = FS[4,2]
 29. 
.         *========= var3 first stage ===================================================
.         estimates restore _ivreg2_var3
 30.         local N_fs = e(N)
 31. 
.         foreach p in var6 var7 var4 {
 32.                 local b    = _b[`p']
 33.                 local se   = _se[`p']
 34.                 local t    = `b'/`se'
 35.                 local pval = 2*ttail(e(df_r), abs(`t'))
 36. 
.                 post handle_fs ("`tag'") ("`y'") ("var3") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F3') (`rkf') (`N_fs')
 37.         }
 38. 
.         *========= var5 first stage ===================================================
.         estimates restore _ivreg2_var5
 39.         local N_fs = e(N)
 40. 
.         foreach p in var6 var7 var4 {
 41.                 local b    = _b[`p']
 42.                 local se   = _se[`p']
 43.                 local t    = `b'/`se'
 44.                 local pval = 2*ttail(e(df_r), abs(`t'))
 45. 
.                 post handle_fs ("`tag'") ("`y'") ("var5") ("`p'") ///
>                                                 (`b') (`se') (`pval') ///
>                                                 (`F5') (`rkf') (`N_fs')
 46.         }
 47. 
. }
>> FE spec: (tag=msaindustrytime)
   – outcome: total_contributions_q100
(dropped 2942 singleton observations)
(MWFE estimator converged in 164 iterations)

HDFE Linear regression                            Number of obs   =     49,470
Absorbing 3 HDFE groups                           F(   3,   4580) =       7.73
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.7292
                                                  Adj R-squared   =     0.6744
                                                  Within R-sq.    =     0.0017
Number of clusters (user_id) =      4,581         Root MSE        =    16.6358

                            (Std. err. adjusted for 4,581 clusters in user_id)
------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |    -2.6237   1.166229    -2.25   0.025     -4.91007   -.3373288
        var5 |   8.199772     3.2814     2.50   0.012     1.766646     14.6329
        var4 |   -9.77696   2.899109    -3.37   0.001    -15.46061    -4.09331
       _cons |   51.29071   .3671983   139.68   0.000     50.57082    52.01059
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-------------------------------------------------------------------+
               Absorbed FE | Categories  - Redundant  = Num. Coefs |
---------------------------+---------------------------------------|
                   firm_id |      1027           1        1026     |
                   user_id |      4581        4581           0    *|
     msa_id#industry_id#yh |      2763          40        2723     |
-------------------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(dropped 2942 singleton observations)
(MWFE estimator converged in 164 iterations)

Stored estimation results
-------------------------
---------------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-------------------------------------------------------------
_ivreg2_var3 | ivreg2         var3          3  First-stage regression: var3
_ivreg2_var5 | ivreg2         var5          3  First-stage regression: var5
---------------------------------------------------------------------------

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on user_id

Number of clusters (user_id) =    4581                Number of obs =    49470
                                                      F(  3,  4580) =     5.82
                                                      Prob > F      =   0.0006
Total (centered) SS     =  11403867.05                Centered R2   =  -0.2361
Total (uncentered) SS   =  11403867.05                Uncentered R2 =  -0.2361
Residual SS             =  14096478.61                Root MSE      =    17.56

------------------------------------------------------------------------------
             |               Robust
total_co~100 | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        var3 |  -69.24661   32.94794    -2.10   0.036    -133.8405   -4.652762
        var5 |   56.16667   21.60591     2.60   0.009     13.80868    98.52467
        var4 |  -38.22355   16.10574    -2.37   0.018    -69.79856   -6.648539
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             10.283
                                                   Chi-sq(1) P-val =    0.0013
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):               55.725
                         (Kleibergen-Paap rk Wald F statistic):          4.805
Stock-Yogo weak ID test critical values: 10% maximal IV size              7.03
                                         15% maximal IV size              4.58
                                         20% maximal IV size              3.95
                                         25% maximal IV size              3.63
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         var3 var5
Included instruments: var4
Excluded instruments: var6 var7
Partialled-out:       _cons
                      nb: total SS, model F and R2s are after partialling-out;
                          any small-sample adjustments include partialled-out
                          variables in regressor count K
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-------------------------------------------------------------------+
               Absorbed FE | Categories  - Redundant  = Num. Coefs |
---------------------------+---------------------------------------|
                   firm_id |      1027           1        1026     |
                   user_id |      4581        4581           0    *|
     msa_id#industry_id#yh |      2763          40        2723     |
-------------------------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(results _ivreg2_var3 are active now)
(results _ivreg2_var5 are active now)

. 
. 
. 
. 
. //-------------------------------------------------------------
. // Close & export CSV
. //-------------------------------------------------------------
. postclose handle

. use `out', clear

. export delimited using "`result_dir'/consolidated_results.csv", ///
>     replace delimiter(",") quote
(file ../results/raw/user_productivity_alternative_fe_balanced_pre/consolidated_results.csv not found)
file ../results/raw/user_productivity_alternative_fe_balanced_pre/consolidated_results.csv saved

.         
. *------------------------------------------------------------
. *  Write first-stage CSV to disk
. *------------------------------------------------------------
. postclose handle_fs

. use `out_fs', clear

. export delimited using "`result_dir'/first_stage_fstats.csv", ///
>         replace delimiter(",") quote
(file ../results/raw/user_productivity_alternative_fe_balanced_pre/first_stage_fstats.csv not found)
file ../results/raw/user_productivity_alternative_fe_balanced_pre/first_stage_fstats.csv saved

.                 
. 
. display as result "→ main CSV       : `result_dir'/consolidated_results.csv"
→ main CSV       : ../results/raw/user_productivity_alternative_fe_balanced_pre/consolidated_results.csv

. display as result "→ first-stage CSV: `result_dir'/first_stage_fstats.csv"
→ first-stage CSV: ../results/raw/user_productivity_alternative_fe_balanced_pre/first_stage_fstats.csv

. 
. log close
      name:  <unnamed>
       log:  /Users/saul/Dropbox/Remote Work Startups/main/spec/log/user_productivity_alternative_fe_balanced_pre.log
  log type:  text
 closed on:  11 Jun 2025, 08:39:18
-----------------------------------------------------------------------------------------------------------------------------------------
